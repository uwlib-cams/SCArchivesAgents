@prefix ex: <http://example.org/rules/>.
@prefix rml: <http://semweb.mmlab.be/ns/rml#>.
@prefix rr: <http://www.w3.org/ns/r2rml#>.
@prefix ql: <http://semweb.mmlab.be/ns/ql#>.

ex:AccessionMap a rr:TriplesMap;
	rml:logicalSource [
		rml:source "accessionData.xml";
		rml:referenceFormulation ql:XPath;
		rml:iterator "datadoc/json/map"
	].

	ex:AccessionMap rr:subjectMap [
		rr:template "http://example.org/rules/creator-{string[@key='id_0']}" # arbitrary URI
	].

	ex:AccessionMap rr:predicateObjectMap [
		rr:predicate ex:partOfCollection;
		rr:objectMap [
			rml:reference "string[@key='title']";
			rr:termType rr:Literal
		]
	].

	ex:AccessionMap rr:predicateObjectMap [
		rr:predicate ex:hasName;
		rr:objectMap [
			rml:reference "array[@key='linked_agents']/map[string[contains(.,'creator')]]/map[@key='_resolved']/string[@key='title']";
			rr:termType rr:Literal
		]
	].

	ex:AccessionMap rr:predicateObjectMap [
		rr:predicate ex:hasURL;
		rr:objectMap [
			rml:reference "array[@key='linked_agents']/map[string[contains(.,'creator')]]/map/string[contains(., 'archiveswest')]";
			rr:termType rr:IRI
		]
	].

	ex:AccessionMap rr:predicateObjectMap [
		rr:predicate ex:hasNote;
		rr:objectMap [
			rml:reference "array[@key='linked_agents']/map[string[contains(.,'creator')]]/map/array[@key='notes']/map[contains(.,'note_bioghist')]/array[@key='subnotes']/map/string[@key='content']"
		]
	].
